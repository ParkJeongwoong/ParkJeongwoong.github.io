{"pageProps":{"markdown":"# [GitHub Blog 개발기] SEO 구현(3) - Next.js app\r\n\r\n현재 블로그를 Next.js 로의 전환하는 과정을 진행 중이다.\r\n\r\n다음은 실제로 전환하는 과정에서 생겼던 예상치 못한 이슈들과 해결 방법이다.\r\n\r\n\r\n\r\n## Dynamic Routing 방법\r\n\r\n각 페이지가 HTML인 형식\r\n\r\n대괄호([])로 감싼 폴더 => 슬래쉬(/) 역할\r\n\r\n\r\n\r\n\r\n\r\n## Markdown file Parsing 문제\r\n\r\nhttps://growd.tistory.com/78\r\n\r\n\r\n\r\n[수정내역]\r\n\r\n- Before\r\n\r\n```javascript\r\nuseEffect(() => {\r\n  if (path) {\r\n    const readmePath = require(`store/article_data/${path.split(\"/\")[2]}/${\r\n      path.split(\"/\")[3]\r\n    }`);\r\n\r\n    // 파일 가져오기\r\n    fetch(readmePath.default)\r\n      .then(r => r.text())\r\n      .then(text => {\r\n        setMarkdown(text);\r\n      });\r\n    setIsLoading(false);\r\n  }\r\n}, [markdown, path]);\r\n```\r\n\r\n\r\n\r\n- After\r\n\r\n```javascript\r\nuseEffect(() => {\r\n  if (path) {\r\n    const readmePath = require(`store/article_data/${path.split(\"/\")[2]}/${\r\n      path.split(\"/\")[3]\r\n    }`);\r\n\r\n    // 파일 가져오기\r\n    setMarkdown(readmePath.default);\r\n    setIsLoading(false);\r\n  }\r\n}, [markdown, path]);\r\n```\r\n\r\n\r\n\r\n## `CSS, JS 파일이 동작하지 않는 문제`\r\n\r\n![image-20211009102133216](../../../../public/assets/image-20211009102133216.png)\r\n\r\n\r\n\r\n모든 준비를 끝내고 Github에 Push를 했더니 위와 같은 페이지가 나왔다...\r\n\r\n분명히 Local에서 npm run dev로 실행했을 땐 제대로 페이지가 나왔었는데 Github에서만 이상하게 동작을 했다.\r\n\r\n\r\n\r\n알고보니 원인은 단순했다.\r\n\r\n1. `.nojekyll` 파일의 존재를 몰랐던 것.\r\n   1. GitHub Pages는 jekyll 기반으로 동작\r\n   2. .nojekyll 파일이 root에 없으면 _로 시작하는 폴더를 읽지 못함\r\n   3. JS, CSS 파일은 _next 폴더 안에 있기 때문에 JS, CSS 파일에 접근 X\r\n   4. 웹페이지가 제대로 동작 X\r\n\r\n2. 위의 문제를 파악하지 못하고 `next.config.js` 파일에 `assetPrefix: \"./\"`를 사용\r\n   1. 나중에 .nojekyll을 추가\r\n   2. Dynamic Routing을 하는 /articles/[articleCategory]/[articleId] 의 파일들은 Build - Out 시 Root에서 2 Depth를 더 들어가야 존재\r\n   3. Dynamic Routing을 하는 페이지들도 _next 폴더에서 JS, CSS를 찾아야 하는데 prefix가 \"./\"으로 되어 있어 Root 폴더가 아닌 Root에서 2 Depth를 들어간 상태에서 _next 폴더에 대한 접근을 시도\r\n\r\n\r\n\r\n해결책은 간단했다.\r\n\r\n1. `.nojekyll` 파일 추가\r\n2. `next.config.js` 에서 assetPrefix 제거\r\n\r\n\r\n\r\n## Markdown Local Image File 문제 (글 작성 중)\r\n\r\n- Build - Export 시 Public의 Image만 사용 가능\r\n\r\n\r\n\r\n## .nojekyll 파일 gh-pages 실행 시 GitHub에 Push되지 않는 문제\r\n\r\n**원인** : out 폴더에 .nojekyll 파일을 넣어 두더라도, **gh-pages -d out** 실행 시, Dot File (.으로 시작하는 파일)은 Push 하지 않으며 기존의 저장소와 비교하여 쓸모 없는 파일은 제거 하는 과정을 거치고 Push 한다.\r\n\r\n\r\n\r\n**해결책** : 옵션 --add와 --dotfiles 을 명령어 뒤에 붙여준다.\r\n\r\n```bash\r\ngh-pages --add --dotfiles -d build\r\n(--add는 최초에만 필요)\r\n```\r\n\r\n- --add : 기존의 저장소와 비교 후 쓸모없는 파일을 지우지 않음 (최초로 Push할 때 필요)\r\n- --dotfiles : .으로 시작하는 파일을 Push 함\r\n\r\n\r\n\r\n---\r\n\r\n출처 : https://imestory.tistory.com/entry/gh-pages%EC%99%80-Github-Pages-%EC%BB%A4%EC%8A%A4%ED%85%80-%EB%8F%84%EB%A9%94%EC%9D%B8-%EC%84%A4%EC%A0%95-%EB%B0%8F-%EC%82%BD%EC%A7%88%EA%B8%B0\r\n\r\n\r\n\r\n## 남은 개선 사항\r\n\r\n- Image 파일 변경 (next/imgaes= 사용)\r\n- 서버 개발 및 연결","documentTitle":"[GitHub Blog 개발기] SEO 구현(3) - Next.js app"},"__N_SSG":true}